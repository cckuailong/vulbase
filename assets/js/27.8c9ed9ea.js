(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{757:function(t,a,s){"use strict";s.r(a);var n=s(103),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"cbc"}},[t._v("CBC "),s("a",{staticClass:"header-anchor",attrs:{href:"#cbc"}},[t._v("#")])]),t._v(" "),s("h2",{attrs:{id:"ç°ä»£å¯†ç ä½“åˆ¶"}},[t._v("ç°ä»£å¯†ç ä½“åˆ¶ "),s("a",{staticClass:"header-anchor",attrs:{href:"#ç°ä»£å¯†ç ä½“åˆ¶"}},[t._v("#")])]),t._v(" "),s("blockquote",[s("p",[t._v("ç°ä»£å¯†ç ä¸­çš„åŠ å¯†ä½“åˆ¶ä¸€èˆ¬åˆ†ä¸ºå¯¹ç§°åŠ å¯†ä½“åˆ¶(Symmetric Key Encryption)å’Œéå¯¹ç§°åŠ å¯†ä½“åˆ¶(Asymmetric Key Encryption)ã€‚å¯¹ç§°åŠ å¯†åˆè¢«åˆ†ä¸ºåˆ†ç»„åŠ å¯†å’Œåºåˆ—å¯†ç ã€‚")]),t._v(" "),s("p",[t._v("åˆ†ç»„å¯†ç ï¼šä¹Ÿå«å—åŠ å¯†(block cyphers)ï¼Œä¸€æ¬¡åŠ å¯†æ˜æ–‡ä¸­çš„ä¸€ä¸ªå—ã€‚åˆ†ç»„å¯†ç æ˜¯å°†æ˜æ–‡æŒ‰ä¸€å®šçš„ä½é•¿åˆ†ç»„ï¼Œæ˜æ–‡ç»„ç»è¿‡åŠ å¯†è¿ç®—å¾—åˆ°å¯†æ–‡ç»„ï¼Œå¯†æ–‡ç»„ç»è¿‡è§£å¯†è¿ç®—ï¼ˆåŠ å¯†è¿ç®—çš„é€†è¿ç®—ï¼‰ï¼Œè¿˜åŸæˆæ˜æ–‡ç»„ï¼Œä¸»è¦æœ‰ ECBï¼ˆç”µå­å¯†ç æœ¬æ¨¡å¼ï¼‰ ï¼ŒCBC ï¼ˆå¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼ï¼‰ ï¼ŒCFB ï¼ˆå¯†æ–‡åé¦ˆæ¨¡å¼ï¼‰ ï¼ŒOFB ï¼ˆè¾“å‡ºåé¦ˆæ¨¡å¼ï¼‰ï¼Œ  CTRæ¨¡å¼ï¼ˆè®¡æ•°å™¨æ¨¡å¼ï¼‰ äº”ç§å·¥ä½œæ¨¡å¼ã€‚")]),t._v(" "),s("p",[t._v("åºåˆ—å¯†ç ï¼šä¹Ÿå«æµåŠ å¯†(stream cyphers)ï¼Œä¸€æ¬¡åŠ å¯†æ˜æ–‡ä¸­çš„ä¸€ä¸ªä½ã€‚åºåˆ—å¯†ç æ˜¯æŒ‡åˆ©ç”¨å°‘é‡çš„å¯†é’¥ï¼ˆåˆ¶ä¹±å…ƒç´ ï¼‰é€šè¿‡æŸç§å¤æ‚çš„è¿ç®—ï¼ˆå¯†ç ç®—æ³•ï¼‰äº§ç”Ÿå¤§é‡çš„ä¼ªéšæœºä½æµï¼Œç”¨äºå¯¹æ˜æ–‡ä½æµçš„åŠ å¯†ã€‚è§£å¯†æ˜¯æŒ‡ç”¨åŒæ ·çš„å¯†é’¥å’Œå¯†ç ç®—æ³•åŠä¸åŠ å¯†ç›¸åŒçš„ä¼ªéšæœºä½æµï¼Œç”¨ä»¥è¿˜åŸæ˜æ–‡ä½æµã€‚")])]),t._v(" "),s("h2",{attrs:{id:"cbc-æ¨¡å¼"}},[t._v("CBC æ¨¡å¼ "),s("a",{staticClass:"header-anchor",attrs:{href:"#cbc-æ¨¡å¼"}},[t._v("#")])]),t._v(" "),s("blockquote",[s("p",[t._v("CBC (Cipher Block Chaining, å¯†ç åˆ†ç»„é“¾æ¥) æ¨¡å¼ä¸­æ¯ä¸€ä¸ªåˆ†ç»„è¦å…ˆå’Œå‰ä¸€ä¸ªåˆ†ç»„åŠ å¯†åçš„æ•°æ®è¿›è¡ŒXORå¼‚æˆ–æ“ä½œï¼Œç„¶åå†è¿›è¡ŒåŠ å¯†ã€‚è¿™æ ·æ¯ä¸ªå¯†æ–‡å—ä¾èµ–è¯¥å—ä¹‹å‰çš„æ‰€æœ‰æ˜æ–‡å—ï¼Œä¸ºäº†ä¿æŒæ¯æ¡æ¶ˆæ¯éƒ½å…·æœ‰å”¯ä¸€æ€§ï¼Œç¬¬ä¸€ä¸ªæ•°æ®å—è¿›è¡ŒåŠ å¯†ä¹‹å‰éœ€è¦ç”¨åˆå§‹åŒ–å‘é‡IVè¿›è¡Œå¼‚æˆ–æ“ä½œã€‚CBCæ¨¡å¼æ˜¯ä¸€ç§æœ€å¸¸ç”¨çš„åŠ å¯†æ¨¡å¼ï¼Œå®ƒä¸»è¦ç¼ºç‚¹æ˜¯éœ€è¦åˆå§‹å‘é‡ï¼ŒåŠ å¯†æ˜¯è¿ç»­çš„ï¼Œä¸èƒ½å¹¶è¡Œå¤„ç†ï¼Œå¹¶ä¸”ä¸ECBä¸€æ ·æ¶ˆæ¯å—å¿…é¡»å¡«å……åˆ°å—å¤§å°çš„æ•´å€æ•°ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"cbc-å·¥ä½œæ¨¡å¼"}},[t._v("CBC å·¥ä½œæ¨¡å¼ "),s("a",{staticClass:"header-anchor",attrs:{href:"#cbc-å·¥ä½œæ¨¡å¼"}},[t._v("#")])]),t._v(" "),s("h3",{attrs:{id:"åŠ å¯†è¿‡ç¨‹"}},[t._v("åŠ å¯†è¿‡ç¨‹ "),s("a",{staticClass:"header-anchor",attrs:{href:"#åŠ å¯†è¿‡ç¨‹"}},[t._v("#")])]),t._v(" "),s("p",[s("img",{attrs:{src:"/wgpsec/images/CBC/CBCE.png",alt:"CBC"}})]),t._v(" "),s("p",[t._v("ä¸Šå›¾ä¸ºCBCåŠ å¯†åŸç†å›¾")]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("Plaintextï¼šæ˜æ–‡ï¼Œå¾…åŠ å¯†çš„æ•°æ®")]),t._v(" "),s("li",[t._v("IV ï¼šåˆå§‹å‘é‡ï¼Œç”¨äºéšæœºåŒ–åŠ å¯†çš„æ¯”ç‰¹å—ï¼Œä¿è¯å³ä½¿å¯¹ç›¸åŒæ˜æ–‡å¤šæ¬¡åŠ å¯†ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ä¸åŒçš„å¯†æ–‡")]),t._v(" "),s("li",[t._v("Keyï¼šåˆ†ç»„åŠ å¯†ä½¿ç”¨çš„å¯¹ç§°å¯†é’¥ï¼Œç”±AESï¼ŒBlowfishï¼ŒDESï¼ŒTriple DESç­‰å¯¹ç§°åŠ å¯†ç®—æ³•ä½¿ç”¨")]),t._v(" "),s("li",[t._v("Ciphertextï¼šåŠ å¯†åçš„æ•°æ®ï¼Œä¹Ÿå«å¯†æ–‡æ•°æ®")]),t._v(" "),s("li",[t._v("å›ºå®šåˆ†ç»„ï¼šCBCåœ¨ä¸€ä¸ªå›ºå®šé•¿åº¦çš„ä½ç»„ä¸Šå·¥ä½œï¼Œç§°ä¸ºå—ã€‚è¿™é‡Œä½¿ç”¨åŒ…å«16å­—èŠ‚çš„å—è¿›è¡Œè¯´æ˜")])])]),t._v(" "),s("h4",{attrs:{id:"æ–‡å­—æµç¨‹"}},[t._v("æ–‡å­—æµç¨‹ "),s("a",{staticClass:"header-anchor",attrs:{href:"#æ–‡å­—æµç¨‹"}},[t._v("#")])]),t._v(" "),s("p",[t._v("ä¸»è¦æµç¨‹ï¼šå‰ä¸€ç»„å¯†æ–‡å—ç”¨æ¥äº§ç”Ÿåä¸€ç»„å¯†æ–‡å—")]),t._v(" "),s("blockquote",[s("ol",[s("li",[t._v("é¦–å…ˆå°†æ˜æ–‡åˆ†ç»„(å¸¸è§çš„ä»¥16å­—èŠ‚ä¸ºä¸€ç»„)ï¼Œä½æ•°ä¸è¶³çš„ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦å¡«å……")]),t._v(" "),s("li",[t._v("ç”Ÿæˆä¸€ä¸ªéšæœºçš„åˆå§‹åŒ–å‘é‡(IV)å’Œä¸€ä¸ªå¯†é’¥")]),t._v(" "),s("li",[t._v("å°†IVå’Œç¬¬ä¸€ç»„æ˜æ–‡å¼‚æˆ–äº§ç”Ÿåˆæ­¥å¯†æ–‡ï¼Œå†ç”¨å¯†é’¥å¯¹åˆæ­¥å¯†æ–‡åŠ å¯†ç”Ÿæˆæœ€ç»ˆå¯†æ–‡å—")]),t._v(" "),s("li",[t._v("ç”¨å¯†é’¥å¯¹3ä¸­xoråäº§ç”Ÿçš„å¯†æ–‡è¿›è¡ŒåŠ å¯†")]),t._v(" "),s("li",[t._v("ç”¨4ä¸­äº§ç”Ÿçš„å¯†æ–‡å¯¹ç¬¬äºŒç»„æ˜æ–‡è¿›è¡Œxoræ“ä½œ")]),t._v(" "),s("li",[t._v("ç”¨å¯†é’¥å¯¹5ä¸­äº§ç”Ÿçš„å¯†æ–‡è¿›è¡ŒåŠ å¯†")]),t._v(" "),s("li",[t._v("é‡å¤4-7ï¼Œç›´è‡³æœ€åä¸€ç»„æ˜æ–‡")]),t._v(" "),s("li",[t._v("å°†IVå’ŒåŠ å¯†åçš„å¯†æ–‡å—æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°æœ€ç»ˆçš„å¯†æ–‡")])])]),t._v(" "),s("p",[t._v("ä»ç¬¬ä¸€å— Plaintext å¼€å§‹ï¼Œé¦–å…ˆä¸ä¸€ä¸ªåˆå§‹å‘é‡IVå¼‚æˆ–ï¼ˆIVåªåœ¨ç¬¬ä¸€å—å‘æŒ¥ä½œç”¨ï¼‰ï¼Œç„¶åæŠŠå¼‚æˆ–çš„ç»“æœç»è¿‡keyè¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°ç¬¬ä¸€å—çš„å¯†æ–‡ï¼Œå¹¶ä¸”æŠŠåŠ å¯†çš„ç»“æœä¸ä¸‹ä¸€å—çš„æ˜æ–‡è¿›è¡Œå¼‚æˆ–ï¼Œä¸€ç›´è¿™æ ·é‡å¤è¿›è¡Œä¸‹å»ç›´è‡³æœ€åä¸€ç»„æ˜æ–‡ã€‚")]),t._v(" "),s("h4",{attrs:{id:"å…¬å¼æè¿°"}},[t._v("å…¬å¼æè¿° "),s("a",{staticClass:"header-anchor",attrs:{href:"#å…¬å¼æè¿°"}},[t._v("#")])]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("Ciphertext-0 = Encrypt(Plaintext XOR IV)\t\t#  åªç”¨äºç¬¬ä¸€ä¸ªç»„å—")]),t._v(" "),s("li",[t._v("Ciphertext-N = Encrypt(Plaintext XOR Ciphertext-(N-1)\t\t#  ç”¨äºç¬¬äºŒåŠå‰©ä¸‹çš„ç»„å—(N > 1)")])])]),t._v(" "),s("h4",{attrs:{id:"ä»£ç è§£æ"}},[t._v("ä»£ç è§£æ "),s("a",{staticClass:"header-anchor",attrs:{href:"#ä»£ç è§£æ"}},[t._v("#")])]),t._v(" "),s("div",{staticClass:"language-C line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("cypher_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("aes_cbc_encrypt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint8_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cypher_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" data_in"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//pad last block with 0")]),t._v("\n    cypher_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" data_in_padding "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("block_padding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data_in"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    cypher_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" cypher_out "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cypher_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("malloc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("sizeof")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint8_t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" data_in"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("len_data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    cypher_out"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("len_data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data_in_padding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("len_data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    uint8_t iv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("memcpy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" IV"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    uint8_t temp_out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint8_t index "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" index "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" data_in_padding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("len_data"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("array_xor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" temp_out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data_in_padding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" iv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æ˜æ–‡ä¸ivå¼‚æˆ–")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_aes128_encryption")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cypher_out"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" index "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" temp_out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//è¿›è¡Œå—åŠ å¯†å¾—åˆ°å¯†æ–‡ï¼ŒåŒæ—¶å¯†æ–‡æ˜¯ä¸‹æ¬¡åŠ å¯†çš„iv")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("memcpy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cypher_out"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" index "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æœ¬æ¬¡çš„å¯†æ–‡æ˜¯ä¸‹æ¬¡åŠ å¯†çš„iv")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data_in_padding"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" cypher_out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br")])]),s("h3",{attrs:{id:"è§£å¯†è¿‡ç¨‹"}},[t._v("è§£å¯†è¿‡ç¨‹ "),s("a",{staticClass:"header-anchor",attrs:{href:"#è§£å¯†è¿‡ç¨‹"}},[t._v("#")])]),t._v(" "),s("p",[s("img",{attrs:{src:"/wgpsec/images/CBC/CBCD.png",alt:"CBCD"}})]),t._v(" "),s("p",[t._v("ä¸Šå›¾ä¸ºCBCè§£å¯†åŸç†å›¾")]),t._v(" "),s("p",[t._v("åªè¦äº†è§£äº†è§£å¯†åŠ å¯†è¿‡ç¨‹ï¼Œåè¿‡æ¥çœ‹è§£å¯†è¿‡ç¨‹ä¹Ÿå°±æ¯”è¾ƒç®€å•äº†")]),t._v(" "),s("h4",{attrs:{id:"æ–‡å­—æµç¨‹-2"}},[t._v("æ–‡å­—æµç¨‹ "),s("a",{staticClass:"header-anchor",attrs:{href:"#æ–‡å­—æµç¨‹-2"}},[t._v("#")])]),t._v(" "),s("p",[t._v("ä¸»è¦æµç¨‹ï¼šå‰ä¸€ç»„å¯†æ–‡å—å½±å“åä¸€ç»„å¯†æ–‡å—çš„è¿˜åŸ")]),t._v(" "),s("blockquote",[s("ol",[s("li",[t._v("ä»å¯†æ–‡ä¸­æå–å‡ºIVï¼Œç„¶åå°†å¯†æ–‡åˆ†ç»„")]),t._v(" "),s("li",[t._v("ä½¿ç”¨å¯†é’¥å¯¹ç¬¬ä¸€ç»„å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œç„¶åå’ŒIVè¿›è¡Œxorå¾—åˆ°æ˜æ–‡")]),t._v(" "),s("li",[t._v("ä½¿ç”¨å¯†é’¥å¯¹ç¬¬äºŒç»„å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œç„¶åå’Œ2ä¸­çš„å¯†æ–‡xorå¾—åˆ°æ˜æ–‡")]),t._v(" "),s("li",[t._v("é‡å¤2-3ï¼Œç›´è‡³æœ€åä¸€ç»„å¯†æ–‡")])])]),t._v(" "),s("h4",{attrs:{id:"å…¬å¼æè¿°-2"}},[t._v("å…¬å¼æè¿° "),s("a",{staticClass:"header-anchor",attrs:{href:"#å…¬å¼æè¿°-2"}},[t._v("#")])]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("Plaintext-0 = Decrypt(Ciphertext) XOR IV\t\t#  åªç”¨äºç¬¬ä¸€ä¸ªç»„å—")]),t._v(" "),s("li",[t._v("Plaintext-N = Decrypt(Ciphertext) XOR Ciphertext-(N-1)\t\t#  ç”¨äºç¬¬äºŒåŠå‰©ä¸‹çš„ç»„å—(N > 1)")])])]),t._v(" "),s("h4",{attrs:{id:"ä»£ç è§£æ-2"}},[t._v("ä»£ç è§£æ "),s("a",{staticClass:"header-anchor",attrs:{href:"#ä»£ç è§£æ-2"}},[t._v("#")])]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[t._v("cypher_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("aes_cbc_decrypt")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint8_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cypher_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" data_in"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    cypher_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" cypher_padding "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("block_padding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data_in"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    cypher_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" plain "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cypher_t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("malloc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data_in"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("len_data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    plain"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("len_data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cypher_padding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("len_data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    uint8_t iv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("memcpy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" IV"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    uint8_t temp_out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint8_t index "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" index "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" cypher_padding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("len_data"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_aes128_decryption")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" temp_out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cypher_padding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//å¯†æ–‡å—è§£å¯†")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("array_xor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" plain"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" temp_out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" iv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//ä¸ivå¼‚æˆ–å¾—åˆ°æ˜æ–‡")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("memcpy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cypher_padding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//è®¾ç½®ä¸‹æ¬¡è§£å¯†ç”¨åˆ°çš„iv")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cypher_padding"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" plain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("h2",{attrs:{id:"padding-oracle"}},[t._v("Padding oracle "),s("a",{staticClass:"header-anchor",attrs:{href:"#padding-oracle"}},[t._v("#")])]),t._v(" "),s("h3",{attrs:{id:"æ”»å‡»æµç¨‹"}},[t._v("æ”»å‡»æµç¨‹ "),s("a",{staticClass:"header-anchor",attrs:{href:"#æ”»å‡»æµç¨‹"}},[t._v("#")])]),t._v(" "),s("p",[t._v("æ˜æ–‡å¡«å……")]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("p",[t._v("åˆ†ç»„å¯†ç  Block Cipher éœ€è¦åœ¨åŠ è½½å‰ç¡®ä¿æ¯ä¸ªæ¯ç»„çš„é•¿åº¦éƒ½æ˜¯åˆ†ç»„é•¿åº¦çš„æ•´æ•°å€ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ˜æ–‡çš„æœ€åä¸€ä¸ªåˆ†ç»„å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°é•¿åº¦ä¸è¶³åˆ†ç»„çš„é•¿åº¦ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("è¿™ä¸ªæ—¶å€™ï¼Œæ™®éçš„åšæ³•æ˜¯åœ¨æœ€åä¸€ç»„å¯†æ–‡å—åå¡«å……ä¸€ä¸ªå›ºå®šçš„å€¼ï¼Œè¿™ä¸ªå€¼çš„å¤§å°ä¸ºå¡«å……çš„å­—èŠ‚æ€»æ•°ã€‚")])])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("æœ€åè¿˜å·®1ä¸ªå­—ç¬¦ï¼Œåˆ™å¡«å……1ä¸ª0x01ï¼›\næœ€åè¿˜å·®2ä¸ªå­—ç¬¦ï¼Œåˆ™å¡«å……2ä¸ª0x02ï¼›\næœ€åè¿˜å·®3ä¸ªå­—ç¬¦ï¼Œåˆ™å¡«å……3ä¸ª0x03ï¼›\næœ€åè¿˜å·®4ä¸ªå­—ç¬¦ï¼Œåˆ™å¡«å……4ä¸ª0x04ï¼›\nè¿™é‡Œç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœæ˜æ–‡é•¿åº¦ä¸º16çš„æ•´æ•°å­—èŠ‚é•¿ï¼Œå®ƒä¹Ÿéœ€è¦å¡«å……ï¼ˆå®ƒä¼šä¸€æ¬¡å¡«å……16ä½ï¼Œä¸”å¡«å……çš„å­—ç¬¦ä¸º0x10ï¼‰\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("ul",[s("li",[t._v("å¡«å……ä¸»è¦å‘ç”Ÿåœ¨æœ€åä¸€ç»„å¯†æ–‡å—ï¼Œæˆ‘ä»¬éœ€è¦æ ¼å¤–å…³æ³¨æœ€åä¸€ä¸ªåˆ†ç»„ã€‚")]),t._v(" "),s("li",[t._v("ä¾‹å¦‚æœ€åä¸€ç»„çš„æœ«å°¾ä¸º0x02,å³è¡¨ç¤ºå¡«å……äº†2ä¸ªPaddingï¼Œå¦‚æœæœ€åçš„Paddingä¸æ­£ç¡®ï¼Œå³å€¼å’Œæ•°é‡ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆè§£å¯†ç¨‹åºå¾€å¾€ä¼šæŠ›å‡ºå¼‚å¸¸(Padding Error)ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åº”ç”¨çš„é”™è¯¯å›æ˜¾ï¼Œåˆ¤æ–­å‡ºPaddingæ˜¯å¦æ­£ç¡®ã€‚")]),t._v(" "),s("li",[t._v("å‰ææ¡ä»¶æ˜¯æœåŠ¡å™¨ä¼šå¯¹æˆ‘ä»¬æ˜¾ç¤ºpadding errorçš„å¼‚å¸¸ï¼Œå¦‚æœä¸å›æ˜¾é‚£ä¹ˆå°±æ— æ³•åˆ¤æ–­å¹¶è¿›è¡Œåˆ©ç”¨ã€‚")]),t._v(" "),s("li",[t._v("ä¾‹å¦‚åœ¨webåº”ç”¨ä¸­ï¼Œå¦‚æœPaddingä¸æ­£ç¡®ï¼Œåˆ™åº”ç”¨ç¨‹åºå¾ˆå¯èƒ½ä¼šè¿”å›500çš„é”™è¯¯ï¼ˆç¨‹åºæ‰§è¡Œé”™è¯¯ï¼‰ï¼›å¦‚æœPaddingæ­£ç¡®ï¼Œä½†è§£å¯†å‡ºæ¥çš„å†…å®¹ä¸æ­£ç¡®ï¼Œåˆ™å¯èƒ½ä¼šè¿”å›200çš„è‡ªå®šä¹‰é”™è¯¯ï¼ˆä¸šåŠ¡ä¸Šçš„è§„å®šï¼‰ã€‚æ‰€ä»¥ï¼Œè¿™ç§åŒºåˆ«å°±å¯ä»¥æˆä¸ºä¸€ä¸ªäºŒå€¼é€»è¾‘çš„â€œæ³¨å…¥ç‚¹â€ã€‚")])])]),t._v(" "),s("p",[t._v("æ”»å‡»æˆç«‹çš„ä¸¤ä¸ªé‡è¦çš„å‡è®¾å‰æï¼š")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("1. æ”»å‡»è€…èƒ½å¤Ÿè·å¾—å¯†æ–‡ï¼ˆCiphertextï¼‰ï¼Œä»¥åŠé™„å¸¦åœ¨å¯†æ–‡å‰é¢çš„IVï¼ˆåˆå§‹åŒ–å‘é‡ï¼‰\n2. æ”»å‡»è€…èƒ½å¤Ÿè§¦å‘å¯†æ–‡çš„è§£å¯†è¿‡ç¨‹ï¼Œä¸”èƒ½å¤ŸçŸ¥é“å¯†æ–‡çš„è§£å¯†ç»“æœ\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("blockquote",[s("ul",[s("li",[t._v("æ”»å‡»æµç¨‹å®é™…ä¸Šæ˜¯ä¸æ–­åœ°è°ƒæ•´IVçš„å€¼ï¼Œåœ¨è§£å¯†ä¹‹åï¼Œæœ€åä¸€ä¸ªå­—èŠ‚çš„å€¼ä¸ºæ­£ç¡®çš„Padding Byteï¼Œå› ä¸ºpaddingæ­£ç¡®æ—¶ï¼Œè¿™æ—¶paddingæ­£ç¡®æ˜¯æŒ‡æœ€ç»ˆè§£å¯†å¹¶å¼‚æˆ–å‡ºæ¥çš„æ˜æ–‡æœ€åä¸€ä¸ªå­—èŠ‚åœ¨æ­£ç¡®paddingçš„èŒƒå›´å†…å°±æ˜¯æ­£ç¡®çš„ï¼Œè™½ç„¶æœ€åå¾—åˆ°çš„æ˜æ–‡ä¸ä¸€å®šæ­£ç¡®ï¼Œä½†æ˜¯paddingæ˜¯åˆæ³•çš„ï¼Œæ‰€ä»¥æœåŠ¡å™¨è¿”å›200 ã€‚")]),t._v(" "),s("li",[t._v("åˆ¤æ–­æƒ…å†µ")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ï¼ˆ1ï¼‰æ­£å¸¸è§£å¯†ï¼Œå¾—åˆ°æ˜æ–‡\nï¼ˆ2ï¼‰è§£å¯†æˆåŠŸï¼Œä½†æ˜¯è§£å¯†å¾—åˆ°çš„å’Œæ˜æ–‡ä¸åŒ¹é…\nï¼ˆ3ï¼‰è§£å¯†é”™è¯¯ï¼ŒæŠ›å‡ºå¼‚å¸¸\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("ul",[s("li",[t._v("ä¾‹å¦‚åŠ å¯†æ•°æ®åº”ç”¨äºcookie")])])]),t._v(" "),s("h2",{attrs:{id:"cbcå­—èŠ‚ç¿»è½¬æ”»å‡»"}},[t._v("CBCå­—èŠ‚ç¿»è½¬æ”»å‡» "),s("a",{staticClass:"header-anchor",attrs:{href:"#cbcå­—èŠ‚ç¿»è½¬æ”»å‡»"}},[t._v("#")])]),t._v(" "),s("h3",{attrs:{id:"æ”»å‡»åŸç†"}},[t._v("æ”»å‡»åŸç† "),s("a",{staticClass:"header-anchor",attrs:{href:"#æ”»å‡»åŸç†"}},[t._v("#")])]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("åœ¨ CBC è§£å¯†çš„å…¬å¼æè¿°ä¸­å¯ä»¥æ³¨æ„åˆ°Ciphertext-(N-1)æ˜¯ç”¨æ¥äº§ç”Ÿä¸‹ä¸€å—æ˜æ–‡ï¼Œè¿™é‡Œæ˜¯å­—èŠ‚ç¿»è½¬æ”»å‡»å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚å¦‚æœæˆ‘ä»¬æ”¹å˜Ciphertext-N-1ä¸­çš„ä¸€ä¸ªå­—èŠ‚ï¼Œç„¶åå’Œä¸‹ä¸€å—è§£å¯†åçš„å¯†æ–‡xorï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸åŒçš„æ˜æ–‡ï¼Œè€Œè¿™ä¸ªæ˜æ–‡æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ã€‚")]),t._v(" "),s("li",[t._v("åœ¨æ­¤åŸºç¡€ä¸Šï¼Œé€šè¿‡ç ´åå¯†æ–‡ä¸­çš„å­—èŠ‚æ¥æ”¹å˜æ˜æ–‡ä¸­çš„å­—èŠ‚ï¼Œå› æ­¤åœ¨ç ´åçš„å¯†æ–‡ä¸­æ·»åŠ å•å¼•å·ç­‰æ¶æ„å­—ç¬¦æ¥ç»•è¿‡è¿‡æ»¤å™¨ï¼Œæˆ–é€šè¿‡å°†ç”¨æˆ·IDæ›´æ”¹ä¸ºadminæ¥æå‡æƒé™ï¼Œæˆ–è€…æ›´æ”¹åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ˜æ–‡é€ æˆå…¶ä»–åæœã€‚")])])]),t._v(" "),s("h3",{attrs:{id:"æ”»å‡»æµç¨‹-2"}},[t._v("æ”»å‡»æµç¨‹ "),s("a",{staticClass:"header-anchor",attrs:{href:"#æ”»å‡»æµç¨‹-2"}},[t._v("#")])]),t._v(" "),s("p",[s("img",{attrs:{src:"/wgpsec/images/CBC/CBCDturn.jpg",alt:"CBCDturn"}})]),t._v(" "),s("blockquote",[s("ul",[s("li",[s("p",[t._v("é€šè¿‡ä¿®æ”¹ç¬¬ä¸€ç»„çš„å¯†æ–‡å—å­—èŠ‚ï¼Œæ¥æ„é€ æˆ‘ä»¬éœ€è¦çš„ç¬¬äºŒç»„æ˜æ–‡ï¼Œ å½“ç¬¬ä¸€ç»„å¯†æ–‡å—å­—èŠ‚å‘ç”Ÿæ”¹å˜æ—¶ä¼šå½±å“ç¬¬ä¸€ç»„æ˜æ–‡å—å’Œç¬¬äºŒç»„æ˜æ–‡å—ã€‚")])]),t._v(" "),s("li",[s("p",[t._v("å‡å¦‚æˆ‘ä»¬å·²çŸ¥çš„æ˜æ–‡è§£å¯†åä¸º1dminï¼Œæˆ‘ä»¬æƒ³æ„é€ ä¸€ä¸ªåˆå§‹IVï¼Œä½¿å…¶è§£å¯†æˆadminï¼Œå› æ­¤æœ‰ä»¥ä¸‹é€»è¾‘ï¼š")])])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("åŸå§‹çš„IV[1]^middle[i]=plain[1]  <<<  é¢˜ç›®é€»è¾‘\nä¿®æ”¹çš„IV[1]^middle[i]='a'       <<<  æˆ‘ä»¬æƒ³è¦\næ„é€ çš„IV[1]=middle[1]^'a'       <<<  æˆ‘ä»¬å¯ä»¥å¾—åˆ°\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("ul",[s("li",[t._v("ç”¨å…¬å¼è¡¨ç¤º")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("A = B ^ C\nC = A ^ B\nA ^ B ^ C = 0\nA ^ B ^ C ^ C' = C'\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("ul",[s("li",[t._v("è€ŒåŸæ¥çš„ä¸­é—´æ˜æ–‡å¯ä»¥å¦‚ä¸‹æ–¹å¼é€šè¿‡ï¼ŒåŸæ¥çš„æ˜æ–‡ç¬¬ä¸€ä½åˆæ˜¯å¯ä»¥é€šè¿‡Padding Oracleæ”»å‡»å¾—åˆ°çš„")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("middle[1]=åŸæ¥çš„IV[1]^plain[1]\t      <<<  Padding Oracle æ”»å‡»\næ„é€ çš„IV[1]=åŸæ¥çš„IV[1]^plain[1]^'a' \t<<<  IVçš„ç¬¬ä¸€ä½\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])])]),t._v(" "),s("h2",{attrs:{id:"é¢˜ç›®å‚è€ƒ"}},[t._v("é¢˜ç›®å‚è€ƒ "),s("a",{staticClass:"header-anchor",attrs:{href:"#é¢˜ç›®å‚è€ƒ"}},[t._v("#")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://buuoj.cn/challenges#%5BNCTF2017%5DBe%20admin",target:"_blank",rel:"noopener noreferrer"}},[t._v("[NCTF2017] Be Admin"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://buuoj.cn/challenges#%5BNPUCTF2020%5Dweb%F0%9F%90%95",target:"_blank",rel:"noopener noreferrer"}},[t._v("[NPUCTF2020]webğŸ•"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);